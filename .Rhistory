collection_longitude,
collection_lat_long_method,
collection_lat_long_method_diff,
fulcrum_altitude,
exif_gps_altitude,
collection_altitude,
collection_altitude_method,
landscape,
sky_view,
ambient_humidity,
substrate,
substrate_notes,
substrate_other,
raw_ambient_temperature,
proc_ambient_temperature,
raw_substrate_temperature,
proc_substrate_temperature,
gridsect,
gridsect_index,
gridsect_radius,
grid_sect_direction,
sample_photo1,
sample_photo2,
sample_photo3,
best_exif_dop_photo = best_photo,
best_sample_photo_caption,
gps_course,
gps_horizontal_accuracy,
gps_speed,
gps_vertical_accuracy)
}
# join all data
if(data_names$data_name %in% c("nematode_field_sampling_proc", "nematode_field_sampling_sample_photo_proc","data$nematode_isolation_proc",
"data$nematode_isolation_s_labeled_plates_proc", "data$nematode_isolation_photos_proc") &&
nrow(data_names) == 5) {
# send message
message("Complete fulcrum data detected, joining all data.")
# join nematode_field_sampling_proc with nematode_isolation_proc
joined_data <- dplyr::full_join(data$nematode_isolation_proc, data$nematode_field_sampling_proc, by = c("c_label_id" = "fulcrum_id")) %>%
dplyr::select(c_label,
everything(),
-c_label_id) %>%
# provide best_photo for joining
dplyr::mutate(best_photo = case_when(
sample_photo1 %in% data$nematode_field_sampling_sample_photo_proc$fulcrum_id ~ sample_photo1,
sample_photo2 %in% data$nematode_field_sampling_sample_photo_proc$fulcrum_id ~ sample_photo2,
sample_photo3 %in% data$nematode_field_sampling_sample_photo_proc$fulcrum_id ~ sample_photo3,
!(sample_photo1 %in% data$nematode_field_sampling_sample_photo_proc$fulcrum_id) & !(sample_photo2 %in% data$nematode_field_sampling_sample_photo_proc$fulcrum_id) &
!(sample_photo3 %in% data$nematode_field_sampling_sample_photo_proc$fulcrum_id) ~ NA_character_)) %>%
# Join nematode_field_sampling_sample_photo to above. In some cases there is not position data from the photos, returns NA for exif.
dplyr::left_join(data$nematode_field_sampling_sample_photo_proc, by = c("best_photo" = "fulcrum_id")) %>%
# Create flag to track if lat and long come from record or photo
dplyr::mutate(collection_lat_long_method = ifelse(is.na(exif_gps_latitude), "fulcrum", "photo")) %>%
# In cases where lat/lon are not available from photo set to collection_fulcrum_latitude and collection_fulcrum_longitude
dplyr::mutate(collection_latitude = ifelse(is.na(exif_gps_latitude), collection_fulcrum_latitude, exif_gps_latitude),
collection_longitude = ifelse(is.na(exif_gps_longitude), collection_fulcrum_longitude, exif_gps_longitude)) %>%
# Add flag for missing isolation records
dplyr::mutate(flag_missing_isolation_record = ifelse(is.na(isolation_by), TRUE, FALSE)) %>%
# Calculate the Haversine distance between fulcrum record_latitude and record_longitue and photo latitude and longitude
dplyr::rowwise() %>%
dplyr::mutate(collection_lat_long_method_diff = geosphere::distHaversine(c(collection_longitude, collection_latitude),
c(collection_fulcrum_longitude, collection_fulcrum_latitude)),
# adjust collection_lat_long_method_diff to NA if there is only a fulcrum GPS postion
collection_lat_long_method_diff = ifelse(collection_lat_long_method == "fulcrum", NA, collection_lat_long_method_diff)) %>%
# fix altitude method and altitude
dplyr::mutate(collection_altitude = ifelse(collection_lat_long_method == "photo" & !(is.na(exif_gps_altitude)), exif_gps_altitude,
ifelse(is.na(exif_gps_altitude) & !(is.na(fulcrum_altitude)), fulcrum_altitude,
ifelse(is.na(exif_gps_altitude) & is.na(fulcrum_altitude), NA))),
collection_altitude_method = ifelse(collection_lat_long_method == "photo" & !(is.na(exif_gps_altitude)), "photo",
ifelse(is.na(exif_gps_altitude) & !(is.na(fulcrum_altitude)), "fulcrum",
ifelse(is.na(exif_gps_altitude) & is.na(fulcrum_altitude), NA, NA)))) %>%
dplyr::ungroup() %>%
# join c-plates to s-plates with nematode_isolation_s_labeled_plates
dplyr::full_join(data$nematode_isolation_s_labeled_plates_proc, .,  by = c("fulcrum_parent_id" = "isolation_id")) %>%
dplyr::select(-fulcrum_parent_id, -updated_by, -version, -geometry, -assigned_to, -status) %>%
# set varible order
dplyr::select(project,
c_label,
s_label,
flag_ambient_temperature,
flag_ambient_temperature_run,
flag_substrate_temperature,
flag_unusual_sample_photo_num,
flag_duplicated_c_label_field_sampling,
flag_duplicated_isolation_for_c_label,
flag_duplicated_s_label_isolation_s_labeled_plates,
flag_missing_s_label_isolation_s_labeled_plates,
flag_missing_isolation_record,
collection_by,
collection_datetime_UTC,
collection_date_UTC,
collection_local_time,
collection_fulcrum_latitude,
collection_fulcrum_longitude,
exif_gps_latitude,
exif_gps_longitude,
collection_latitude,
collection_longitude,
collection_lat_long_method,
collection_lat_long_method_diff,
fulcrum_altitude,
exif_gps_altitude,
collection_altitude,
collection_altitude_method,
landscape,
sky_view,
ambient_humidity,
substrate,
substrate_notes,
substrate_other,
raw_ambient_temperature,
proc_ambient_temperature,
raw_substrate_temperature,
proc_substrate_temperature,
gridsect,
gridsect_index,
gridsect_radius,
grid_sect_direction,
sample_photo1,
sample_photo2,
sample_photo3,
best_exif_dop_photo = best_photo,
best_sample_photo_caption,
best_sample_photo_caption,
gps_course,
gps_horizontal_accuracy,
gps_speed,
gps_vertical_accuracy,
isolation_by,
isolation_datetime_UTC,
isolation_date_UTC,
isolation_local_time,
isolation_latitude,
isolation_longitude,
worms_on_sample,
approximate_number_of_worms)
}
else {
message("Invalid list of dataframes supplied to joinFulcrum. Are there 5 OR 2 processed dataframes in the list? Are they named correctly?")
}
# return data
return(joined_data)
}
# test joinFulcrum function
join_data1 <- joinFulcrum(proc_data1)
library(easyfulcrum)
library(tidyverse)
# set working directory
setwd(glue::glue("{dirname(rstudioapi::getActiveDocumentContext()$path)}/.."))
# setup test directory for multi project Fulcrum export
dir1 <- "test_data/2020FebruaryAustralia/data/fulcrum"
# test readFulcrum function
raw_data1 <- readFulcrum(dir1)
# test procFulcrum function
proc_data1 <- procFulcrum(raw_data1)
# test parameter_check function
parameter_check(proc_data1)
# test parameter_check function with optional parameters set to TRUE
test1 <- parameter_check(proc_data1, save = TRUE, return = TRUE)
# test joinFulcrum function
join_data1 <- joinFulcrum(proc_data1)
will_fail<- joinFulcrum(raw_data1)
# test initial_data_check function
initial_data_check(join_data1)
# test initial_data_check function with optional parameters set to TRUE
test2 <- initial_data_check(join_data1, save = TRUE, return = TRUE)
View(test2)
View(join_data1)
proc_data1$nematode_isolation_s_labeled_plates_proc
proc_slabs <- proc_data1$nematode_isolation_s_labeled_plates_proc
View(proc_slabs)
library(easyfulcrum)
library(easyfulcrum)
library(tidyverse)
# set working directory
setwd(glue::glue("{dirname(rstudioapi::getActiveDocumentContext()$path)}/.."))
# setup test directory for multi project Fulcrum export
dir1 <- "test_data/2020FebruaryAustralia/data/fulcrum"
# test readFulcrum function
raw_data1 <- readFulcrum(dir1)
# test procFulcrum function
proc_data1 <- procFulcrum(raw_data1)
# test parameter_check function
parameter_check(proc_data1)
# test joinFulcrum function
join_data1 <- joinFulcrum(proc_data1)
# test initial_data_check function
initial_data_check(join_data1)
# test initial_data_check function with optional parameters set to TRUE
test2 <- initial_data_check(join_data1, save = TRUE, return = TRUE)
# test annotateFulcrum
anno_data1 <- annotateFulcrum(join_data1)
# test readGenotypes function
geno_data1 <- readGenotypes(gsKey = c("1CxKJHM6mEu4VvnN2T1ioXiJNZmmmpeosmECP2zeAPmY"))
devtools::document
()
devtools::document()
library(easyfulcrum)
library(easyfulcrum)
# set working directory
setwd(glue::glue("{dirname(rstudioapi::getActiveDocumentContext()$path)}/.."))
# setup test directory for multi project Fulcrum export
dir1 <- "test_data/2020FebruaryAustralia/data/fulcrum"
# test readFulcrum function
raw_data1 <- readFulcrum(dir1)
# test procFulcrum function
proc_data1 <- procFulcrum(raw_data1)
# test parameter_check function
parameter_check(proc_data1)
# test parameter_check function with optional parameters set to TRUE
test1 <- parameter_check(proc_data1, save = TRUE, return = TRUE)
# test joinFulcrum function
join_data1 <- joinFulcrum(proc_data1)
if(c("nematode_field_sampling_proc", "nematode_field_sampling_sample_photo_proc", "data$nematode_isolation_proc",
"data$nematode_isolation_s_labeled_plates_proc", "data$nematode_isolation_photos_proc") %in% data_names$data_name &
nrow(data_names) == 5
)
if(c("nematode_field_sampling_proc", "nematode_field_sampling_sample_photo_proc", "data$nematode_isolation_proc",
"data$nematode_isolation_s_labeled_plates_proc", "data$nematode_isolation_photos_proc") %in% data_names$data_name &
nrow(data_names) == 5)
if(c("nematode_field_sampling_proc", "nematode_field_sampling_sample_photo_proc", "data$nematode_isolation_proc",
"data$nematode_isolation_s_labeled_plates_proc", "data$nematode_isolation_photos_proc") %in% data_names$data_name &
nrow(data_names) == 5)
if(c("nematode_field_sampling_proc", "nematode_field_sampling_sample_photo_proc", "data$nematode_isolation_proc",
"data$nematode_isolation_s_labeled_plates_proc", "data$nematode_isolation_photos_proc") %in% data_names$data_name &
nrow(data_names) == 5)
if(c("nematode_field_sampling_proc", "nematode_field_sampling_sample_photo_proc", "data$nematode_isolation_proc",
"data$nematode_isolation_s_labeled_plates_proc", "data$nematode_isolation_photos_proc") %in% data_names$data_name &
nrow(data_names) == 5)
if(c("nematode_field_sampling_proc", "nematode_field_sampling_sample_photo_proc", "data$nematode_isolation_proc",
"data$nematode_isolation_s_labeled_plates_proc", "data$nematode_isolation_photos_proc") %in% data_names$data_name &
nrow(data_names) == 5)
if(c("nematode_field_sampling_proc", "nematode_field_sampling_sample_photo_proc", "data$nematode_isolation_proc",
"data$nematode_isolation_s_labeled_plates_proc", "data$nematode_isolation_photos_proc") %in% data_names$data_name &
nrow(data_names) == 5)
if(c("nematode_field_sampling_proc", "nematode_field_sampling_sample_photo_proc", "data$nematode_isolation_proc",
"data$nematode_isolation_s_labeled_plates_proc", "data$nematode_isolation_photos_proc") %in% data_names$data_name &
nrow(data_names) == 5)
if(c("nematode_field_sampling_proc", "nematode_field_sampling_sample_photo_proc", "data$nematode_isolation_proc",
"data$nematode_isolation_s_labeled_plates_proc", "data$nematode_isolation_photos_proc") %in% data_names$data_name &
nrow(data_names) == 5)
if(c("nematode_field_sampling_proc", "nematode_field_sampling_sample_photo_proc", "data$nematode_isolation_proc",
"data$nematode_isolation_s_labeled_plates_proc", "data$nematode_isolation_photos_proc") %in% data_names$data_name &
nrow(data_names) == 5)
if(c("nematode_field_sampling_proc", "nematode_field_sampling_sample_photo_proc", "data$nematode_isolation_proc",
"data$nematode_isolation_s_labeled_plates_proc", "data$nematode_isolation_photos_proc") %in% data_names$data_name &
nrow(data_names) == 5)
asdf
if(c("nematode_field_sampling_proc", "nematode_field_sampling_sample_photo_proc", "data$nematode_isolation_proc",
"data$nematode_isolation_s_labeled_plates_proc", "data$nematode_isolation_photos_proc") %in% data_names$data_name &
nrow(data_names) == 5)
test <- ifelse((c("nematode_field_sampling_proc", "nematode_field_sampling_sample_photo_proc", "data$nematode_isolation_proc",
"data$nematode_isolation_s_labeled_plates_proc", "data$nematode_isolation_photos_proc") %in% data_names$data_name &
nrow(data_names) == 5), T, F)
location <- getwd()
setwd(paste(location, "/R", sep = ""))
files.sources = list.files()
sapply(files.sources, source)
setwd(location)
# setup test directory for multi project Fulcrum export
dir1 <- "test_data/2020FebruaryAustralia/data/fulcrum"
dir2 <- "test_data/2018OctoberHawaii/data/fulcrum"
dir3 <- "test_data/2019DecemberHawaii/data/fulcrum"
dir4 <- "test_data/2019OctoberHawaii/data/fulcrum"
### TEST 1 ###
# test readFulcrum function
raw_data1 <- readFulcrum(dir1)
# test procFulcrum function
proc_data1 <- procFulcrum(raw_data1)
# test checkParameters function, will output rows with flags/rows related to those w flags
checkParameters(proc_data1)
# test checkParameters function, saves the output as a list of three dataframes of flagged rows
flag1.1 <- checkParameters(proc_data1, return = TRUE)
# easier to see which rows we might want to edit
View(flag1.1)
# upon further inspection we select two rows for ambient_temperature_run to be set to NA
to_change <- c("c5b0cabf-ded8-4c3d-9915-b3c94b913686", "fb975ace-0036-4a80-b073-8ff638f35786")
proc_data1_clean <- fixParameters(proc_data1, ambient_temperature_run_ids = to_change)
# test checkProc function, will output info with flags/rows related to those flags
checkProc(proc_data1)
# test checkParameters function, saves the output as a list of six dataframes of flagged rows
flag1.2 <- checkProc(proc_data1, return = TRUE)
# test joinFulcrum function
join_data1 <- joinFulcrum(proc_data1)
# test checkProc function, will output info of flags/rows related to those flags
checkJoin(join_data1)
# test checkProc function, saves the output as a dataframe of flagged rows
flag1.3 <- checkJoin(join_data1, return = TRUE)
# test annotateFulcrum fuction
anno_data1 <- annotateFulcrum(join_data1)
library(dplyr)
### TEST 1 ###
# test readFulcrum function
raw_data1 <- readFulcrum(dir1)
# test procFulcrum function
proc_data1 <- procFulcrum(raw_data1)
# test checkParameters function, will output rows with flags/rows related to those w flags
checkParameters(proc_data1)
# test checkParameters function, saves the output as a list of three dataframes of flagged rows
flag1.1 <- checkParameters(proc_data1, return = TRUE)
# easier to see which rows we might want to edit
View(flag1.1)
# upon further inspection we select two rows for ambient_temperature_run to be set to NA
to_change <- c("c5b0cabf-ded8-4c3d-9915-b3c94b913686", "fb975ace-0036-4a80-b073-8ff638f35786")
proc_data1_clean <- fixParameters(proc_data1, ambient_temperature_run_ids = to_change)
# test checkProc function, will output info with flags/rows related to those flags
checkProc(proc_data1)
# test checkParameters function, saves the output as a list of six dataframes of flagged rows
flag1.2 <- checkProc(proc_data1, return = TRUE)
# test joinFulcrum function
join_data1 <- joinFulcrum(proc_data1)
# test checkProc function, will output info of flags/rows related to those flags
checkJoin(join_data1)
# test checkProc function, saves the output as a dataframe of flagged rows
flag1.3 <- checkJoin(join_data1, return = TRUE)
# test annotateFulcrum fuction
anno_data1 <- annotateFulcrum(join_data1)
library(stringr)
### TEST 1 ###
# test readFulcrum function
raw_data1 <- readFulcrum(dir1)
# test procFulcrum function
proc_data1 <- procFulcrum(raw_data1)
# test checkParameters function, will output rows with flags/rows related to those w flags
checkParameters(proc_data1)
# test checkParameters function, saves the output as a list of three dataframes of flagged rows
flag1.1 <- checkParameters(proc_data1, return = TRUE)
# easier to see which rows we might want to edit
View(flag1.1)
# upon further inspection we select two rows for ambient_temperature_run to be set to NA
to_change <- c("c5b0cabf-ded8-4c3d-9915-b3c94b913686", "fb975ace-0036-4a80-b073-8ff638f35786")
proc_data1_clean <- fixParameters(proc_data1, ambient_temperature_run_ids = to_change)
# test checkProc function, will output info with flags/rows related to those flags
checkProc(proc_data1)
# test checkParameters function, saves the output as a list of six dataframes of flagged rows
flag1.2 <- checkProc(proc_data1, return = TRUE)
# test joinFulcrum function
join_data1 <- joinFulcrum(proc_data1)
# test checkProc function, will output info of flags/rows related to those flags
checkJoin(join_data1)
# test checkProc function, saves the output as a dataframe of flagged rows
flag1.3 <- checkJoin(join_data1, return = TRUE)
# test annotateFulcrum fuction
anno_data1 <- annotateFulcrum(join_data1)
View(anno_data1)
# test readGenotypes function
geno_data1 <- readGenotypes(gsKey = c("1CxKJHM6mEu4VvnN2T1ioXiJNZmmmpeosmECP2zeAPmY"))
gs4_deauth()
# test readGenotypes function
geno_data1 <- readGenotypes(gsKey = c("1CxKJHM6mEu4VvnN2T1ioXiJNZmmmpeosmECP2zeAPmY"))
location <- getwd()
setwd(paste(location, "/R", sep = ""))
files.sources = list.files()
sapply(files.sources, source)
setwd(location)
# test readGenotypes function
geno_data1 <- readGenotypes(gsKey = c("1CxKJHM6mEu4VvnN2T1ioXiJNZmmmpeosmECP2zeAPmY"))
sheets_auth9
library(googlesheets4
)
sheets_auth()
gs4_auth()
# test readGenotypes function
geno_data1 <- readGenotypes(gsKey = c("1CxKJHM6mEu4VvnN2T1ioXiJNZmmmpeosmECP2zeAPmY"))
gs4_auth()
# test readGenotypes function
geno_data1 <- readGenotypes(gsKey = c("1CxKJHM6mEu4VvnN2T1ioXiJNZmmmpeosmECP2zeAPmY"))
location <- getwd()
setwd(paste(location, "/R", sep = ""))
files.sources = list.files()
sapply(files.sources, source)
setwd(location)
# setup test directory for multi project Fulcrum export
dir1 <- "test_data/2020FebruaryAustralia/data/fulcrum"
dir2 <- "test_data/2018OctoberHawaii/data/fulcrum"
dir3 <- "test_data/2019DecemberHawaii/data/fulcrum"
dir4 <- "test_data/2019OctoberHawaii/data/fulcrum"
### TEST 1 ###
# test readFulcrum function
raw_data1 <- readFulcrum(dir1)
# test procFulcrum function
proc_data1 <- procFulcrum(raw_data1)
location <- getwd()
setwd(paste(location, "/R", sep = ""))
files.sources = list.files()
sapply(files.sources, source)
setwd(location)
# test checkParameters function, will output rows with flags/rows related to those w flags
checkParameters(proc_data1)
data <- proc_data1
ambient_temperature_run <- data[[1]] %>%
dplyr::arrange(collection_datetime_UTC)
#replace NA values in the flag with FALSE, doesn't matter for this purpose
ambient_temperature_run$flag_ambient_temperature_run <-
tidyr::replace_na(ambient_temperature_run$flag_ambient_temperature_run, FALSE)
ambient_temperature_run <- data[[1]] %>%
dplyr::arrange(collection_datetime_UTC)
#replace NA values in the flag with FALSE, doesn't matter for this purpose
ambient_temperature_run$flag_ambient_temperature_run <-
tidyr::replace_na(ambient_temperature_run$flag_ambient_temperature_run, FALSE)
#add another logical for adjacent rows, will later delete
ambient_temperature_run$temp <- rep(FALSE, nrow(ambient_temperature_run))
for(i in 1:5){
if(ambient_temperature_run$flag_ambient_temperature_run[i]==TRUE){
ambient_temperature_run$temp[1:i] <- TRUE
ambient_temperature_run$temp[i+1:5] <- TRUE
}
}
for(i in 6:(nrow(ambient_temperature_run)-6)){
if(ambient_temperature_run$flag_ambient_temperature_run[i]==TRUE){
ambient_temperature_run$temp[i] <- TRUE
ambient_temperature_run$temp[i+1:5] <- TRUE
ambient_temperature_run$temp[i-1:5] <- TRUE
}
}
for(i in (nrow(ambient_temperature_run)-5):nrow(ambient_temperature_run)){
if(ambient_temperature_run$flag_ambient_temperature_run[i]==TRUE){
ambient_temperature_run$temp[i:nrow(ambient_temperature_run)] <- TRUE
ambient_temperature_run$temp[i-1:5] <- TRUE
}
}
ambient_temperature_run <- ambient_temperature_run %>%
dplyr::filter(temp == TRUE) %>% dplyr::select(-matches("temp"))
print(paste("There are", sum(ambient_temperature_run$flag_ambient_temperature_run),
"rows with flagged ambient run temperature:", sep = " "))
if(sum(ambient_temperature_run$flag_ambient_temperature_run) > 0){
to_return <- ambient_temperature_run %>%
dplyr::select(fulcrum_id, raw_ambient_temperature, ambient_humidity,
flag_ambient_temperature_run, collection_local_time, collection_datetime_UTC)
View(ambient_temperature_run)
message(">>> Checking ambient run temperature")
#arrange by collection_datetime
ambient_temperature_run <- data[[1]] %>%
dplyr::arrange(collection_datetime_UTC)
#replace NA values in the flag with FALSE, doesn't matter for this purpose
ambient_temperature_run$flag_ambient_temperature_run <-
tidyr::replace_na(ambient_temperature_run$flag_ambient_temperature_run, FALSE)
#add another logical for adjacent rows, will later delete
ambient_temperature_run$temp <- rep(FALSE, nrow(ambient_temperature_run))
for(i in 1:5){
if(ambient_temperature_run$flag_ambient_temperature_run[i]==TRUE){
ambient_temperature_run$temp[1:i] <- TRUE
ambient_temperature_run$temp[i+1:5] <- TRUE
}
}
for(i in 6:(nrow(ambient_temperature_run)-6)){
if(ambient_temperature_run$flag_ambient_temperature_run[i]==TRUE){
ambient_temperature_run$temp[i] <- TRUE
ambient_temperature_run$temp[i+1:5] <- TRUE
ambient_temperature_run$temp[i-1:5] <- TRUE
}
}
for(i in (nrow(ambient_temperature_run)-5):nrow(ambient_temperature_run)){
if(ambient_temperature_run$flag_ambient_temperature_run[i]==TRUE){
ambient_temperature_run$temp[i:nrow(ambient_temperature_run)] <- TRUE
ambient_temperature_run$temp[i-1:5] <- TRUE
}
}
test <- ambient_temperature_run %>%
dplyr::filter(temp == TRUE)
View(test)
dim(test)
test <- ambient_temperature_run %>%
dplyr::filter(temp == TRUE) %>% dplyr::select(-matches("temp"))
dim(test)
test <- ambient_temperature_run %>%
dplyr::filter(temp == TRUE) %>% dplyr::select(-temp)
dim(test)
location <- getwd()
setwd(paste(location, "/R", sep = ""))
files.sources = list.files()
sapply(files.sources, source)
setwd(location)
# test checkParameters function, will output rows with flags/rows related to those w flags
checkParameters(proc_data1)
flag1.1 <- checkParameters(proc_data1, return = TRUE)
View(flag1.1)
location <- getwd()
setwd(paste(location, "/R", sep = ""))
files.sources = list.files()
sapply(files.sources, source)
setwd(location)
flag1.1 <- checkParameters(proc_data1, return = TRUE)
flag1.1
location <- getwd()
setwd(paste(location, "/R", sep = ""))
files.sources = list.files()
sapply(files.sources, source)
setwd(location)
flag1.1 <- checkParameters(proc_data1, return = TRUE)
location <- getwd()
setwd(paste(location, "/R", sep = ""))
files.sources = list.files()
sapply(files.sources, source)
setwd(location)
flag1.1 <- checkParameters(proc_data1, return = TRUE)
to_change <- c("c5b0cabf-ded8-4c3d-9915-b3c94b913686", "fb975ace-0036-4a80-b073-8ff638f35786")
proc_data1_clean <- fixParameters(proc_data1, ambient_temperature_run_ids = to_change)
flag1.1 <- checkParameters(proc_data1_clean, return = TRUE)
# test checkProc function, will output info with flags/rows related to those flags
checkProc(proc_data1)
# test checkParameters function, saves the output as a list of six dataframes of flagged rows
flag1.2 <- checkProc(proc_data1, return = TRUE)
# test joinFulcrum function
join_data1 <- joinFulcrum(proc_data1)
# test checkProc function, will output info of flags/rows related to those flags
checkJoin(join_data1)
# test checkProc function, saves the output as a dataframe of flagged rows
flag1.3 <- checkJoin(join_data1, return = TRUE)
# test annotateFulcrum fuction
anno_data1 <- annotateFulcrum(join_data1)
# test readGenotypes function
geno_data1 <- readGenotypes(gsKey = c("1CxKJHM6mEu4VvnN2T1ioXiJNZmmmpeosmECP2zeAPmY"))
# test joinGenoFulc function to join genotype data to fulcrum data
joingeno_data1 <- joinGenoFulc(geno = geno_data1, fulc = anno_data1)
location <- getwd()
setwd(paste(location, "/R", sep = ""))
files.sources = list.files()
sapply(files.sources, source)
setwd(location)
# test joinGenoFulc function to join genotype data to fulcrum data
joingeno_data1 <- joinGenoFulc(geno = geno_data1, fulc = anno_data1)
# test the procPhotos function, output is final dataframe
photodir <- "test_data/2020FebruaryAustralia/data/fulcrum/photos"
final_data1 <- procPhotos(photodir, joingeno_data1)
# test readFulcrum function
raw_data4 <- readFulcrum(dir4)
# test procFulcrum function
proc_data4 <- procFulcrum(raw_data4)
# test checkParameters function, will output rows with flags/rows related to those w flags
checkParameters(proc_data4)
# test checkParameters function, saves the output as a list of three dataframes
test4 <- checkParameters(proc_data4, return = TRUE)
# upon further inspection we select all rows for ambient_temperature_run to be set to NA
to_change <- test4$fulcrum_id
proc_data4_clean <- fixParameters(proc_data4, substrate_temperature_ids = to_change)
# test checkProc function, will output info of flags/rows related to those flags
checkProc(proc_data4)
# test checkParameters function, saves the output as a list of six dataframes of flagged rows
flag4.2 <- checkProc(proc_data4, return = TRUE)
# test joinFulcrum function
join_data4 <- joinFulcrum(proc_data4)
# test checkProc function, will output info of flags/rows related to those flags
checkJoin(join_data4)
# test checkProc function, saves the output as a dataframe of flagged rows
flag4.3 <- checkJoin(join_data4, return = TRUE)
# test annotateFulcrum fuction
anno_data4 <- annotateFulcrum(join_data4)
# test readGenotypes function
geno_data4 <- readGenotypes(gsKey = c("1CxKJHM6mEu4VvnN2T1ioXiJNZmmmpeosmECP2zeAPmY"))
# test joinGenoFulc function to join genotype data to fulcrum data
joingeno_data4 <- joinGenoFulc(geno = geno_data4, fulc = anno_data4)
