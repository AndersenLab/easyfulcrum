names(fulc_data) <- c("nematode_field_sampling_sample_photo",
"nematode_field_sampling.csv",
"nematode_isolation_photos.csv",
"nematode_isolation_s_labeled_plates.csv",
"nematode_isolation.csv")
View(fulc_data)
# set names
names(fulc_data) <- c("nematode_field_sampling_sample_photo",
"nematode_field_sampling",
"nematode_isolation_photos",
"nematode_isolation_s_labeled_plates",
"nematode_isolation")
# set working directory
setwd(glue::glue("{dirname(rstudioapi::getActiveDocumentContext()$path)}/.."))
# setup test directory for multi project Fulcrum export
test_dir1 <- "test_data/20200515_fulcrum_data"
# test functions from multi project Fulcrum export
loadFulcrum(test_dir1)
library(easyfulcrum)
library(tidyverse)
# set working directory
setwd(glue::glue("{dirname(rstudioapi::getActiveDocumentContext()$path)}/.."))
# setup test directory for multi project Fulcrum export
test_dir1 <- "test_data/20200515_fulcrum_data"
# test functions from multi project Fulcrum export
loadFulcrum(test_dir1)
# set working directory
setwd(glue::glue("{dirname(rstudioapi::getActiveDocumentContext()$path)}/.."))
# setup test directory for multi project Fulcrum export
test_dir1 <- "test_data/20200515_fulcrum_data"
# test functions from multi project Fulcrum export
loadFulcrum(test_dir1)
View(collection)
library(readr)
nematode_field_sampling <- read_csv("test_data/2020FebruaryAustralia/data/fulcrum/nematode_field_sampling.csv")
View(nematode_field_sampling)
glimpse(nematode_field_sampling)
View(collection)
View(collection)
glimpse(collection)
library(readr)
nematode_field_sampling_sample_photo <- read_csv("test_data/2020FebruaryAustralia/data/fulcrum/nematode_field_sampling_sample_photo.csv")
View(nematode_field_sampling_sample_photo)
glimpse(nematode_field_sampling_sample_photo)
View(nematode_field_sampling_sample_photo)
library(readr)
nematode_isolation <- read_csv("test_data/2020FebruaryAustralia/data/fulcrum/nematode_isolation.csv")
View(nematode_isolation)
glimpse(nematode_isolation)
View(isolation)
glipse(isolation)
glimpse(isolation)
library(readr)
nematode_isolation_s_labeled_plates <- read_csv("test_data/2020FebruaryAustralia/data/fulcrum/nematode_isolation_s_labeled_plates.csv")
View(nematode_isolation_s_labeled_plates)
glimipse(nematode_isolation_s_labeled_plates)
glimpse(nematode_isolation_s_labeled_plates)
View(isolation_photo)
View(isolation_photo)
library(readr)
nematode_isolation_photos <- read_csv("test_data/2020FebruaryAustralia/data/fulcrum/nematode_isolation_photos.csv")
View(nematode_isolation_photos)
glimpse(nematode_isolation_photos)
View(isolation)
View(nematode_isolation)
View(nematode_isolation)
library(easyfulcrum)
library(tidyverse)
# set working directory
setwd(glue::glue("{dirname(rstudioapi::getActiveDocumentContext()$path)}/.."))
# setup test directory for multi project Fulcrum export
test_dir1 <- "test_data/20200515_fulcrum_data"
# test functions from multi project Fulcrum export
loadFulcrum(test_dir1)
# test functions from multi project Fulcrum export
readFulcrum(test_dir1)
# test functions from multi project Fulcrum export
dat <- readFulcrum(test_dir1)
View(dat)
# setup test directory for multi project Fulcrum export
test_dir1 <- "test_data/2020FebruaryAustralia/data/fulcrum"
# test functions from multi project Fulcrum export
test_data1 <- readFulcrum(test_dir1)
# test readFulcrum function
raw_test_data1 <- readFulcrum(test_dir1)
# test procFulcrum function
proc_test_data1 <- procFulcrum(raw_test_data1)
View(raw_test_data1)
library(easyfulcrum)
library(tidyverse)
# set working directory
setwd(glue::glue("{dirname(rstudioapi::getActiveDocumentContext()$path)}/.."))
# setup test directory for multi project Fulcrum export
test_dir1 <- "test_data/2020FebruaryAustralia/data/fulcrum"
# test readFulcrum function
raw_test_data1 <- readFulcrum(test_dir1)
library(tidyverse)
# set working directory
setwd(glue::glue("{dirname(rstudioapi::getActiveDocumentContext()$path)}/.."))
# setup test directory for multi project Fulcrum export
test_dir1 <- "test_data/2020FebruaryAustralia/data/fulcrum"
# test readFulcrum function
raw_test_data1 <- readFulcrum(test_dir1)
View(raw_test_data1)
# test procFulcrum function
proc_test_data1 <- procFulcrum(raw_test_data1)
debug(procFulcrum)
# test procFulcrum function
proc_test_data1 <- procFulcrum(raw_test_data1)
library(easyfulcrum)
library(tidyverse)
# set working directory
setwd(glue::glue("{dirname(rstudioapi::getActiveDocumentContext()$path)}/.."))
# setup test directory for multi project Fulcrum export
test_dir1 <- "test_data/2020FebruaryAustralia/data/fulcrum"
# test readFulcrum function
raw_test_data1 <- readFulcrum(test_dir1)
# test procFulcrum function
proc_test_data1 <- procFulcrum(raw_test_data1)
View(proc_test_data1)
library(easyfulcrum)
library(tidyverse)
# set working directory
setwd(glue::glue("{dirname(rstudioapi::getActiveDocumentContext()$path)}/.."))
# setup test directory for multi project Fulcrum export
test_dir1 <- "test_data/2020FebruaryAustralia/data/fulcrum"
# test readFulcrum function
raw_test_data1 <- readFulcrum(test_dir1)
# test procFulcrum function
proc_test_data1 <- procFulcrum(raw_test_data1)
View(proc_test_data1)
library(easyfulcrum)
library(tidyverse)
# set working directory
setwd(glue::glue("{dirname(rstudioapi::getActiveDocumentContext()$path)}/.."))
# setup test directory for multi project Fulcrum export
test_dir1 <- "test_data/2020FebruaryAustralia/data/fulcrum"
# test readFulcrum function
raw_test_data1 <- readFulcrum(test_dir1)
# test procFulcrum function
proc_test_data1 <- procFulcrum(raw_test_data1)
View(proc_test_data1)
# test joinFulcrum function
join_test_data1 <- joinFulcrum(proc_test_data1)
View(join_test_data1)
# test annotateFulcrum fuction
anno_test_data1 <- annotateFulcrum(join_test_data1)
View(anno_test_data1)
# test readGenotypes function
geno_test_data1 <- readGenotypes(gsKey = c("1CxKJHM6mEu4VvnN2T1ioXiJNZmmmpeosmECP2zeAPmY"))
View(geno_test_data1)
# test joinGenoFulc function to join genotype data to fulcrum data
joingeno_data1 <- joinGenoFulc(fulc = aus2020feb, geno = geno_data1)
# test joinGenoFulc function to join genotype data to fulcrum data
joingeno_data1 <- joinGenoFulc(fulc = anno_data1, geno = geno_data1)
# test annotateFulcrum fuction
anno_data1 <- annotateFulcrum(join_data1)
# setup test directory for multi project Fulcrum export
dir1 <- "test_data/2020FebruaryAustralia/data/fulcrum"
# test readFulcrum function
raw_data1 <- readFulcrum(dir1)
# test procFulcrum function
proc_data1 <- procFulcrum(raw_data1)
# test joinFulcrum function
join_data1 <- joinFulcrum(proc_data1)
# test annotateFulcrum fuction
anno_data1 <- annotateFulcrum(join_data1)
# test readGenotypes function
geno_data1 <- readGenotypes(gsKey = c("1CxKJHM6mEu4VvnN2T1ioXiJNZmmmpeosmECP2zeAPmY"))
# test joinGenoFulc function to join genotype data to fulcrum data
joingeno_data1 <- joinGenoFulc(fulc = anno_data1, geno = geno_data1)
View(join_data1)
View(proc_test_data1)
view(proc_data1[[1]])
view(proc_data1[[3]])
View(proc_data1)
View(proc_data1)
library(easyfulcrum)
library(tidyverse)
# set working directory
setwd(glue::glue("{dirname(rstudioapi::getActiveDocumentContext()$path)}/.."))
# setup test directory for multi project Fulcrum export
dir1 <- "test_data/2020FebruaryAustralia/data/fulcrum"
# test readFulcrum function
raw_data1 <- readFulcrum(dir1)
# test procFulcrum function
proc_data1 <- procFulcrum(raw_data1)
# test joinFulcrum function
join_data1 <- joinFulcrum(proc_data1)
View(join_data1)
View(proc_data1)
View(raw_data1)
View(raw_data1[[4]])
library(easyfulcrum)
library(tidyverse)
# set working directory
setwd(glue::glue("{dirname(rstudioapi::getActiveDocumentContext()$path)}/.."))
# setup test directory for multi project Fulcrum export
dir1 <- "test_data/2020FebruaryAustralia/data/fulcrum"
# test readFulcrum function
raw_data1 <- readFulcrum(dir1)
# test procFulcrum function
proc_data1 <- procFulcrum(raw_data1)
# test joinFulcrum function
join_data1 <- joinFulcrum(proc_data1)
# test annotateFulcrum fuction
anno_data1 <- annotateFulcrum(join_data1)
join_data1
View(join_data1)
library(easyfulcrum)
library(tidyverse)
# set working directory
setwd(glue::glue("{dirname(rstudioapi::getActiveDocumentContext()$path)}/.."))
# setup test directory for multi project Fulcrum export
dir1 <- "test_data/2020FebruaryAustralia/data/fulcrum"
# test readFulcrum function
raw_data1 <- readFulcrum(dir1)
# test procFulcrum function
proc_data1 <- procFulcrum(raw_data1)
# test joinFulcrum function
join_data1 <- joinFulcrum(proc_data1)
# test annotateFulcrum fuction
anno_data1 <- annotateFulcrum(join_data1)
View(anno_data1)
View(anno_data1)
View(join_data1)
View(join_data1)
library(easyfulcrum)
glimpse(join_data1)
library(easyfulcrum)
library(tidyverse)
# set working directory
setwd(glue::glue("{dirname(rstudioapi::getActiveDocumentContext()$path)}/.."))
# setup test directory for multi project Fulcrum export
dir1 <- "test_data/2020FebruaryAustralia/data/fulcrum"
# test readFulcrum function
raw_data1 <- readFulcrum(dir1)
# test procFulcrum function
proc_data1 <- procFulcrum(raw_data1)
# test joinFulcrum function
join_data1 <- joinFulcrum(proc_data1)
# test annotateFulcrum fuction
anno_data1 <- annotateFulcrum(join_data1)
View(join_data1)
View(anno_data1)
glimpse(anno_data1)
library(easyfulcrum)
library(tidyverse)
# set working directory
setwd(glue::glue("{dirname(rstudioapi::getActiveDocumentContext()$path)}/.."))
# setup test directory for multi project Fulcrum export
dir1 <- "test_data/2020FebruaryAustralia/data/fulcrum"
# test readFulcrum function
raw_data1 <- readFulcrum(dir1)
# test procFulcrum function
proc_data1 <- procFulcrum(raw_data1)
# test joinFulcrum function
join_data1 <- joinFulcrum(proc_data1)
# test annotateFulcrum fuction
anno_data1 <- annotateFulcrum(join_data1)
View(join_data1)
glimpse(join_data1)
View(anno_data1)
glimpse(anno_data1)
library(easyfulcrum)
library(easyfulcrum)
library(tidyverse)
# set working directory
setwd(glue::glue("{dirname(rstudioapi::getActiveDocumentContext()$path)}/.."))
# setup test directory for multi project Fulcrum export
dir1 <- "test_data/2020FebruaryAustralia/data/fulcrum"
# test readFulcrum function
raw_data1 <- readFulcrum(dir1)
# test procFulcrum function
proc_data1 <- procFulcrum(raw_data1)
# test joinFulcrum function
join_data1 <- joinFulcrum(proc_data1)
# test annotateFulcrum fuction
anno_data1 <- annotateFulcrum(join_data1)
# test readGenotypes function
geno_data1 <- readGenotypes(gsKey = c("1CxKJHM6mEu4VvnN2T1ioXiJNZmmmpeosmECP2zeAPmY"))
View(anno_data1)
library(tidyverse)
# set working directory
setwd(glue::glue("{dirname(rstudioapi::getActiveDocumentContext()$path)}/.."))
# setup test directory for multi project Fulcrum export
dir1 <- "test_data/2020FebruaryAustralia/data/fulcrum"
# test readFulcrum function
raw_data1 <- readFulcrum(dir1)
# test procFulcrum function
proc_data1 <- procFulcrum(raw_data1)
# test joinFulcrum function
join_data1 <- joinFulcrum(proc_data1)
# test annotateFulcrum fuction
anno_data1 <- annotateFulcrum(join_data1)
# test readGenotypes function
geno_data1 <- readGenotypes(gsKey = c("1CxKJHM6mEu4VvnN2T1ioXiJNZmmmpeosmECP2zeAPmY"))
# test joinGenoFulc function to join genotype data to fulcrum data
joingeno_data1 <- joinGenoFulc(fulc = anno_data1, geno = geno_data1)
library(easyfulcrum)
library(easyfulcrum)
library(tidyverse)
# set working directory
setwd(glue::glue("{dirname(rstudioapi::getActiveDocumentContext()$path)}/.."))
# setup test directory for multi project Fulcrum export
dir1 <- "test_data/2020FebruaryAustralia/data/fulcrum"
# test readFulcrum function
raw_data1 <- readFulcrum(dir1)
# test procFulcrum function
proc_data1 <- procFulcrum(raw_data1)
# test joinFulcrum function
join_data1 <- joinFulcrum(proc_data1)
# test annotateFulcrum fuction
anno_data1 <- annotateFulcrum(join_data1)
# test readGenotypes function
geno_data1 <- readGenotypes(gsKey = c("1CxKJHM6mEu4VvnN2T1ioXiJNZmmmpeosmECP2zeAPmY"))
View(anno_data1)
View(anno_data1)
View(geno_data1)
# test joinGenoFulc function to join genotype data to fulcrum data
joingeno_data1 <- joinGenoFulc(geno = geno_data1, fulc = anno_data1,)
View(joingeno_data1)
glimpse(joingeno_data1)
library(easyfulcrum)
library(tidyverse)
# set working directory
setwd(glue::glue("{dirname(rstudioapi::getActiveDocumentContext()$path)}/.."))
# setup test directory for multi project Fulcrum export
dir1 <- "test_data/2020FebruaryAustralia/data/fulcrum"
# test readFulcrum function
raw_data1 <- readFulcrum(dir1)
# test procFulcrum function
proc_data1 <- procFulcrum(raw_data1)
# test joinFulcrum function
join_data1 <- joinFulcrum(proc_data1)
# test annotateFulcrum fuction
anno_data1 <- annotateFulcrum(join_data1)
View(anno_data1)
View(raw_data1)
View(join_data1)
View(proc_data1)
View(proc_data1)
View(raw_data1$nematode_isolation_photos)
View(raw_data1$nematode_field_sampling_sample_photo)
View(raw_data1$nematode_field_sampling)
View(proc_data1)
View(anno_data1)
anno_data1$sample_photo_url
View(anno_data1)
glimpse(anno_data1)
View(join_data1)
glimpse(join_data1)
# test readGenotypes function
geno_data1 <- readGenotypes(gsKey = c("1CxKJHM6mEu4VvnN2T1ioXiJNZmmmpeosmECP2zeAPmY"))
View(geno_data1)
# test joinGenoFulc function to join genotype data to fulcrum data
joingeno_data1 <- joinGenoFulc(geno = geno_data1, fulc = anno_data1,)
glimpse(joingeno_data1)
library(easyfulcrum)
# test readGenotypes function
geno_data1 <- readGenotypes(gsKey = c("1CxKJHM6mEu4VvnN2T1ioXiJNZmmmpeosmECP2zeAPmY"))
glimpse(joingeno_data1)
library(easyfulcrum)
library(tidyverse)
# set working directory
setwd(glue::glue("{dirname(rstudioapi::getActiveDocumentContext()$path)}/.."))
# setup test directory for multi project Fulcrum export
dir1 <- "test_data/2020FebruaryAustralia/data/fulcrum"
# test readFulcrum function
raw_data1 <- readFulcrum(dir1)
# test procFulcrum function
proc_data1 <- procFulcrum(raw_data1)
# test joinFulcrum function
join_data1 <- joinFulcrum(proc_data1)
# test annotateFulcrum fuction
anno_data1 <- annotateFulcrum(join_data1)
# test readGenotypes function
geno_data1 <- readGenotypes(gsKey = c("1CxKJHM6mEu4VvnN2T1ioXiJNZmmmpeosmECP2zeAPmY"))
# test joinGenoFulc function to join genotype data to fulcrum data
joingeno_data1 <- joinGenoFulc(geno = geno_data1, fulc = anno_data1,)
View(joingeno_data1)
procPhotos <- function(dir) {
# make subdirectory
fs::dir_create(glue::glue("{dir}/processed_photos"))
}
##########################3
photo_dir_test <- "/Users/tim/repos/easyfulcrum/test_data/2020FebruaryAustralia/data/fulcrum/photos"
library(easyfulcrum)
procPhotos(photo_dir_test)
?stringr::suffix
?str_suffix
View(joingeno_data1)
?file.copy
?dir_ls()
test <- dir_ls(photo_dir_test)
test <- fs::dir_ls(photo_dir_test)
test
# get file list
orig_file_list <- dir_ls(photo_dir_test)
# get file list
orig_file_list <- fs::dir_ls(photo_dir_test)
# find file names for sampling photos of samples with strain names
to_change <- joingeno_data1 %>%
dplyr::filter(!is.na(ECA_name)) %>%
dplyr::mutate(orig_file_name = glue::glue("{dir}/{sample_photo}.jpg"),
new_file_name = glue::glue("{dir}/processed_photos/{ECA_name}_{collection_id}.jpg"))
##########################3
dir <- "/Users/tim/repos/easyfulcrum/test_data/2020FebruaryAustralia/data/fulcrum/photos"
# get file list
orig_file_list <- fs::dir_ls(dir)
# find file names for sampling photos of samples with strain names
to_change <- joingeno_data1 %>%
dplyr::filter(!is.na(ECA_name)) %>%
dplyr::mutate(orig_file_name = glue::glue("{dir}/{sample_photo}.jpg"),
new_file_name = glue::glue("{dir}/processed_photos/{ECA_name}_{collection_id}.jpg"))
# find file names for sampling photos of samples with strain names
to_change <- joingeno_data1 %>%
dplyr::filter(!is.na(ECA_name)) %>%
dplyr::mutate(orig_file_name = glue::glue("{dir}/{sample_photo}.jpg"),
new_file_name = glue::glue("{dir}/processed_photos/{ECA_name}_{c_label}.jpg"))
View(to_change)
# find file names for sampling photos of samples with strain names
to_change <- joingeno_data1 %>%
dplyr::filter(!is.na(ECA_name)) %>%
dplyr::mutate(orig_file_name = glue::glue("{dir}/{sample_photo}.jpg"),
new_file_name = glue::glue("{dir}/processed_photos/{ECA_name}_{c_label}.jpg")) %>%
dplyr::select(orig_file_name, new_file_name)
View(to_change)
# filter original file list to the photos we want
stain_file_list <- orig_file_list %>%
dplyr::filter(fs_path %in% to_change$orig_file_name)
# copy files to new directory and rename
fs::file_copy(to_change$orig_file_name, to_change$new_file_name, overwrite = F)
# make thumbs
# function for making thumb
makeThumb <- function(file, height, width) {
require(png)
img <- readPNG(file)
png(file = paste("thumb", file, sep = "_"), height = height, width = width)
par(mar=c(0,0,0,0), xaxs="i", yaxs="i", ann=FALSE)
plot(1:2, type='n', xaxt = "n", yaxt = "n", xlab = "", ylab = "")
lim <- par()
rasterImage(img, lim$usr[1], lim$usr[3], lim$usr[2], lim$usr[4])
dev.off()
}
makeThumb("/Users/tim/repos/easyfulcrum/test_data/2020FebruaryAustralia/data/fulcrum/photos/processed_photos/ECA2657_C-5268.jpg", 200, 200)
img <- jpeg::readJPEG("/Users/tim/repos/easyfulcrum/test_data/2020FebruaryAustralia/data/fulcrum/photos/processed_photos/ECA2657_C-5268.jpg")
?png
# function for making thumb
makeThumb <- function(file, size = 0.2) {
require(jpeg)
img <- readJPEG(file)
h<-dim(img)[1] # image height
w<-dim(img)[2] # image width
jpeg(file = paste("thumb", file, sep = "_"), height = h*size, width = w*size)
par(mar=c(0,0,0,0), xaxs="i", yaxs="i", ann=FALSE)
plot(1:2, type='n', xaxt = "n", yaxt = "n", xlab = "", ylab = "")
lim <- par()
rasterImage(img, lim$usr[1], lim$usr[3], lim$usr[2], lim$usr[4])
dev.off()
}
makeThumb("/Users/tim/repos/easyfulcrum/test_data/2020FebruaryAustralia/data/fulcrum/photos/processed_photos/ECA2657_C-5268.jpg")
img <- jpeg::readJPEG("/Users/tim/repos/easyfulcrum/test_data/2020FebruaryAustralia/data/fulcrum/photos/processed_photos/ECA2657_C-5268.jpg")
getwd()
# function for making thumb
makeThumb <- function(file, size = 0.2) {
require(jpeg)
img <- readJPEG(file)
h<-dim(img)[1] # image height
w<-dim(img)[2] # image width
jpeg(file = "ECA2657_C-5268_test.jpg", height = h*size, width = w*size)
par(mar=c(0,0,0,0), xaxs="i", yaxs="i", ann=FALSE)
plot(1:2, type='n', xaxt = "n", yaxt = "n", xlab = "", ylab = "")
lim <- par()
rasterImage(img, lim$usr[1], lim$usr[3], lim$usr[2], lim$usr[4])
dev.off()
}
makeThumb("/Users/tim/repos/easyfulcrum/test_data/2020FebruaryAustralia/data/fulcrum/photos/processed_photos/ECA2657_C-5268.jpg")
?rasterImage
?plot
# function for making thumb
makeThumb <- function(file, size = 0.2) {
img <- jpeg::readJPEG(file)
h<-dim(img)[1] # image height
w<-dim(img)[2] # image width
jpeg::jpeg(file = glue::glue("thumb_{file}"), height = h*size, width = w*size)
par(mar=c(0,0,0,0), xaxs="i", yaxs="i", ann=FALSE)
plot(1:2, type='n', xaxt = "n", yaxt = "n", xlab = "", ylab = "")
lim <- par()
rasterImage(img, lim$usr[1], lim$usr[3], lim$usr[2], lim$usr[4])
dev.off()
}
makeThumb("ECA2657_C-5268.jpg")
makeThumb("/Users/tim/repos/easyfulcrum/test_data/2020FebruaryAustralia/data/fulcrum/photos/processed_photos/ECA2657_C-5268.jpg")
library(easyfulcrum)
# setup test directory for multi project Fulcrum export
dir1 <- "test_data/2020FebruaryAustralia/data/fulcrum"
# test readFulcrum function
raw_data1 <- readFulcrum(dir1)
View(raw_data1)
# test procFulcrum function
proc_data1 <- procFulcrum(raw_data1)
View(proc_data1)
# test joinFulcrum function
join_data1 <- joinFulcrum(proc_data1)
View(join_data1)
# test annotateFulcrum fuction
anno_data1 <- annotateFulcrum(join_data1)
# test readGenotypes function
geno_data1 <- readGenotypes(gsKey = c("1CxKJHM6mEu4VvnN2T1ioXiJNZmmmpeosmECP2zeAPmY"))
# test joinGenoFulc function to join genotype data to fulcrum data
joingeno_data1 <- joinGenoFulc(geno = geno_data1, fulc = anno_data1,)
